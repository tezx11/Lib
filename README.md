This is not mine, it's Stefanuk's script that I'm trying to fix.
